{"version":3,"sources":["App.tsx","index.tsx"],"names":["App","state","leftTimeZone","moment","tz","zone","localStorage","getItem","rightTimeZone","modal","components","timeGutterHeader","react_default","a","createElement","className","title","_this","name","onClick","handleIconSpanClick","getVulgarUtcOffsetText","utcOffset","Date","now","handleSwitchLeftTimeZoneButtonClick","abbr","handleSwitchRightTimeZoneButtonClick","timeSlotWrapper","props","typedProps","undefined","resource","dateAndTimeUtc","utc","value","dateAndTimeTzLeft","clone","dateAndTimeTzRight","format","children","event","alert","currentTarget","setState","side","search","handleSwitchTimeZoneSearchInputChange","Error","Object","objectSpread","handleSwitchTimeZoneSelectChange","setItem","handleCloseModalButtonClick","offsetMinutes","offsetSign","Math","sign","offsetHours","abs","floor","offsetHoursFraction","toFixed","substring","concat","offsetFraction","_this2","this","results","names","map","n","vulgarOffset","fractionalOffset","getFractionalUtcOffsetText","filter","toUpperCase","includes","onChange","placeholder","ref","focus","size","key","Fragment","react_big_calendar_esm","localizer","events","defaultView","scrollToTime","createPortal","renderSwitchModal","document","body","Component","BigCalendar","momentLocalizer","start","startOf","toDate","end","endOf","add","render","App_App","getElementById"],"mappings":"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","file":"static/js/main.30d1cc7f.chunk.js","sourcesContent":["import './App.css';\nimport 'react-big-calendar/lib/css/react-big-calendar.css';\nimport React, { Component, ReactElement, ChangeEventHandler, MouseEventHandler } from 'react';\nimport BigCalendar, { Components } from 'react-big-calendar';\nimport moment, { MomentZone } from 'moment';\nimport tz from 'moment-timezone';\nimport { createPortal } from 'react-dom';\n\ntype AppState = {\n  leftTimeZone: MomentZone;\n  rightTimeZone: MomentZone;\n  modal: null | { side: 'left' | 'right'; search: string; };\n};\n\nexport default class App extends Component<{}, AppState> {\n  public readonly state: AppState = {\n    leftTimeZone: moment.tz.zone(localStorage.getItem('left') || 'America/New_York')!,\n    rightTimeZone: moment.tz.zone(localStorage.getItem('right') || 'Europe/Prague')!,\n    modal: null,\n  };\n\n  private static readonly localizer = BigCalendar.momentLocalizer(moment);\n\n  private static readonly events = [\n    {\n      title: 'This day',\n      start: moment().startOf('day').toDate(),\n      end: moment().endOf('day').toDate(),\n    },\n    {\n      title: 'Now for an hour',\n      start: moment().toDate(),\n      end: moment().add(1, 'hour').toDate(),\n    }\n  ];\n\n  private components: Components = {\n    timeGutterHeader: () => {\n      return (\n        // Note that `rbc-time-header-gutter` is to have the header dynamically strethed to match the width of the gutter by RBC\n        <div className=\"gutterSplit rbc-time-header-gutter\">\n          <span>\n            <span title={this.state.leftTimeZone.name} onClick={this.handleIconSpanClick}>{this.getVulgarUtcOffsetText(this.state.leftTimeZone.utcOffset(Date.now()))}</span>\n            <button onClick={this.handleSwitchLeftTimeZoneButtonClick}>…</button>\n            <span>{this.state.leftTimeZone.abbr(Date.now())}</span>\n          </span>\n          <span>UTC</span>\n          <span>\n            <span title={this.state.rightTimeZone.name} onClick={this.handleIconSpanClick}>{this.getVulgarUtcOffsetText(this.state.rightTimeZone.utcOffset(Date.now()))}</span>\n            <button onClick={this.handleSwitchRightTimeZoneButtonClick}>…</button>\n            <span>{this.state.rightTimeZone.abbr(Date.now())}</span>\n          </span>\n        </div>\n      );\n    },\n    timeSlotWrapper: (props) => {\n      const typedProps: { value: Date, resource: null | undefined, children: ReactElement } = props as any;\n      if (typedProps.resource === undefined) {\n        const dateAndTimeUtc = moment.utc(typedProps.value);\n        const dateAndTimeTzLeft = dateAndTimeUtc.clone().tz(this.state.leftTimeZone.name);\n        const dateAndTimeTzRight = dateAndTimeUtc.clone().tz(this.state.rightTimeZone.name);\n        return (\n          <div className=\"gutterSplit rbc-time-slot\">\n            <span title={dateAndTimeTzLeft.format()}>\n              {dateAndTimeTzLeft.format('HH:mm A')}\n            </span>\n            <span title={dateAndTimeUtc.format()}>\n              {dateAndTimeUtc.format('HH:mm A')}\n            </span>\n            <span title={dateAndTimeTzRight.format()}>\n              {dateAndTimeTzRight.format('HH:mm A')}\n            </span>\n          </div>\n        );\n      }\n\n      return typedProps.children;\n    },\n  };\n\n  private getVulgarUtcOffsetText(offsetMinutes: number) {\n    const offsetSign = ['+', '', '-'][Math.sign(offsetMinutes / 60) + 1 /* Convert sign -1 | 0 | 1 to index 0 | 1 | 2 */];\n    const offsetHours = Math.abs(Math.floor(offsetMinutes / 60));\n    let offsetHoursFraction = (Math.abs(offsetMinutes / 60) % 1).toFixed(2).substring(1) /* Discard 0 leaving fraction */;\n\n    // http://unicodefractions.com/\n    switch (offsetHoursFraction) {\n      case '.00': offsetHoursFraction = ''; break;\n      case '.25': offsetHoursFraction = `¼`; break;\n      case '.50': offsetHoursFraction = `½`; break;\n      case '.75': offsetHoursFraction = `¾`; break;\n    }\n\n    return `UTC${offsetSign}${offsetHours || ''}${offsetHoursFraction}`;\n  }\n\n  private getFractionalUtcOffsetText(offsetMinutes: number) {\n    const offsetSign = ['+', '', '-'][Math.sign(offsetMinutes / 60) + 1 /* Convert sign -1 | 0 | 1 to index 0 | 1 | 2 */];\n    const offsetFraction = offsetMinutes / 60; // 0.5\n    return `UTC${offsetSign}${offsetFraction}`;\n  }\n\n  private renderSwitchModal() {\n    if (this.state.modal === null) {\n      throw new Error('Invalid state');\n    }\n\n    const search = this.state.modal.search;\n    const results = moment.tz.names()\n      .map(n => moment.tz.zone(n)!)\n      .map(tz => ({ name: tz.name, offsetMinutes: tz.utcOffset(Date.now()) }))\n      .map(tz => ({ name: tz.name, vulgarOffset: this.getVulgarUtcOffsetText(tz.offsetMinutes), fractionalOffset: this.getFractionalUtcOffsetText(tz.offsetMinutes) }))\n\n      // Search the time zone name, vulgar offset and fractional offset to be able to search all time zones with a given offset\n      .filter(tz => (tz.name.toUpperCase() + ' ' + tz.vulgarOffset + ' ' + tz.fractionalOffset).includes(search.toUpperCase()));\n\n    return (\n      <div className=\"modal\">\n        <div>\n          Change the {this.state.modal.side} time zone\n          <button title=\"Close\" onClick={this.handleCloseModalButtonClick}>✕</button>\n        </div>\n        <input value={this.state.modal.search} onChange={this.handleSwitchTimeZoneSearchInputChange} placeholder=\"Search: 'prague', '-2', '.75', …\" ref={n => n && n.focus()} />\n        <select onChange={this.handleSwitchTimeZoneSelectChange} size={20}>\n          {results.map(tz => <option value={tz.name} key={tz.name}>{tz.name} {tz.vulgarOffset}</option>)}\n        </select>\n      </div>\n    );\n  }\n\n  private readonly handleIconSpanClick: MouseEventHandler<HTMLSpanElement> = event => {\n    alert(event.currentTarget.title);\n  };\n\n  private readonly handleSwitchLeftTimeZoneButtonClick = () => {\n    this.setState({ modal: { side: 'left', search: '' } });\n  };\n\n  private readonly handleSwitchRightTimeZoneButtonClick = () => {\n    this.setState({ modal: { side: 'right', search: '' } });\n  };\n\n  private readonly handleSwitchTimeZoneSearchInputChange: ChangeEventHandler<HTMLInputElement> = event => {\n    const search = event.currentTarget.value;\n    this.setState(state => {\n      if (state.modal === null) {\n        throw new Error('Invalid state');\n      }\n\n      return { modal: { ...state.modal, search } };\n    });\n  };\n\n  private readonly handleSwitchTimeZoneSelectChange: ChangeEventHandler<HTMLSelectElement> = event => {\n    if (this.state.modal === null) {\n      throw new Error('Invalid state');\n    }\n\n    const tz = moment.tz.zone(event.currentTarget.value)!;\n    switch (this.state.modal.side) {\n      case 'left': {\n        this.setState({ leftTimeZone: tz, modal: null });\n        localStorage.setItem('left', event.currentTarget.value);\n        return;\n      }\n      case 'right': {\n        this.setState({ rightTimeZone: tz, modal: null });\n        localStorage.setItem('right', event.currentTarget.value);\n        return;\n      }\n    }\n\n    throw new Error('Called in an invalid state.');\n  };\n\n  private readonly handleCloseModalButtonClick = () => {\n    this.setState({ modal: null });\n  }\n\n  public render() {\n    // Note that a reference to `tz` needs to be kept otherwise it gets compiled away even though it is needed for `moment.tz`\n    void tz;\n    return (\n      <>\n        <BigCalendar localizer={App.localizer} events={App.events} components={this.components} defaultView=\"week\" scrollToTime={new Date()} />\n        {this.state.modal && createPortal(this.renderSwitchModal(), document.body)}\n      </>\n    );\n  }\n};\n","import './index.css';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport App from './App';\n\nrender(<App />, document.getElementById('root'));\n"],"sourceRoot":""}